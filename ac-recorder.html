<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="../iron-localstorage/iron-localstorage.html">
<dom-module id="ac-recorder">
    <template>
        <style>
            :host {
            }
        </style>
        <iron-localstorage name="alicia_adorada2" value="{{instrumentActivity}}" ></iron-localstorage>
    </template>
    <script>
        Polymer({
            is: "ac-recorder",
            observers: [],
            behaviors:[],
            listeners: {},
            properties: {
                instrumentActivity:{
                    type:Object
                },
                recordedTime:{
                    type:Number,
                    value:0
                },
                lastRecordTime:{
                    type:Number,
                    value:0
                }
            },
            startRecording: function(){
                this.instrumentActivity.recording = [] ;
                this.lastRecordTime = context.currentTime;
            },
            addActivity: function(cmd,button,velocity,channel){
                var activity ={};
                activity.cmd = cmd ;
                activity.time = context.currentTime ;
                activity.button = button ;
                activity.channel = channel ;
                this.instrumentActivity.recording.push(activity) ;
                console.log("added activity " + activity.cmd + " " +activity.time + " "+ activity.button + " "+  activity.channel);
            },
            saveRecording: function(){
                var tmp = this.instrumentActivity ;
                this.instrumentActivity = {} ;
                this.instrumentActivity = tmp ;
            },
            dbug: function(){
                console.log(this.instrumentActivity );
                // convert notes to json
                // uploadjson
            },
            ready: function () {
                Polymer.RenderStatus.afterNextRender(this, function(){
                    this.instrumentActivity = { recording:[]} ;
                }) ;
            }
        });
    </script>
</dom-module>
